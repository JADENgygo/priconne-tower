<meta charset="utf-8"><meta name="description"content="プリコネRのタワーパズル"><meta name="twitter:card"content="summary"><meta name="twitter:site"content="@JADENgygo"><meta property="og:url"content="https://priconne-tower.vercel.app"><meta property="og:title"content="プリコネタワー"><meta property="og:description"content="プリコネRのタワーパズル"><meta property="og:image"content="https://priconne-tower.vercel.app/peko.png"><meta name="viewport"content="width=640"><title>プリコネタワー</title><link rel="icon"href="../peko.png"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"rel="stylesheet"integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"crossorigin="anonymous"><style>.content{position:relative;min-height:100vh;padding:0}footer{position:absolute;bottom:0;width:100%}</style><body class="text-center"><div class="content"><div class="conatiner"><p class="fs-1 pt-3">プリコネタワー<p>全てのプリンを一番右のお皿に移動させるとクリア！<p>大きいプリンは小さいプリンの上には置けないよ<p>最小31回でクリアできるよ<div id="game"></div></div><footer class="bg-secondary bg-opacity-25 text-center pt-3 pb-3"><div><a href="https://twitter.com/@JADENgygo"classname="me-3 link-dark"><img src="../twitter.svg"></a><a href="https://priconne-portfolio.vercel.app"class="link-dark">プリコネツール</a></div><div>画像: &copy; Cygames, Inc.</div></footer></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script><script>const config={parent:"game",type:Phaser.AUTO,width:640,height:480,physics:{default:"arcade",arcade:{gravity:{y:200}}},scene:{preload:preload,create:create,update:update}},game=new Phaser.Game(config);function preload(){this.load.image("plate","../plate.png"),this.load.image("peko","../pudding_peko.png")}const scales=[.6,.5,.4,.3,.2];let positions=[[0,1,2,3,4],[],[]],puddings=[],target=null,offset=0,score=0,exploded=!1,scoreText,passedText,resetText;function create(){this.add.graphics().fillStyle(16777215,1).fillRect(0,0,640,480);const e=this.add.image(110,400,"plate"),t=(e.setScale(.8),this.add.image(320,400,"plate")),s=(t.setScale(.8),this.add.image(530,400,"plate"));s.setScale(.8);for(let e=0;e<5;++e){const n=this.add.image(0,0,"peko");n.setScale(scales[e]),puddings.push(n)}const a=this.add.graphics().fillStyle(16777215,0).fillRect(0,0,640/3,480).setInteractive(new Phaser.Geom.Rectangle(0,0,640/3,480),Phaser.Geom.Rectangle.Contains),o=(a.on("pointerdown",e=>move(0)),this.add.graphics().fillStyle(16777215,0).fillRect(640/3,0,1280/3,480).setInteractive(new Phaser.Geom.Rectangle(640/3,0,1280/3,480),Phaser.Geom.Rectangle.Contains)),i=(o.on("pointerdown",e=>move(1)),this.add.graphics().fillStyle(16777215,0).fillRect(1280/3,0,640,480).setInteractive(new Phaser.Geom.Rectangle(1280/3,0,640,480),Phaser.Geom.Rectangle.Contains));i.on("pointerdown",e=>move(2)),scoreText=this.add.text(530,50,"移動回数\n0回",{font:"20px sans-serif",fill:"#000"}),passedText=this.add.text(260,200,"",{font:"30px sans-serif",fill:"#ff0000"}),(resetText=this.add.text(50,50,"リセット",{font:"20px sans-serif",fill:"#ff0000"}).setInteractive()).on("pointerdown",e=>{positions=[[0,1,2,3,4],[],[]],puddings.forEach(e=>e.angle=0),target=null,offset=0,score=0,scoreText.text="移動回数\n0回",exploded=!1,passedText.text="",resetText.text="リセット",resetText.x=50,resetText.y=50,resetText.setFill("#ff0000")})}const move=e=>{if(5===positions[2].length)exploded=!0;else{if(null===target)return 0===positions[e].length?void 0:(offset=50-offset,void(target=e));var t;target===e?(offset=50-offset,target=null):positions[target][positions[target].length-1]<positions[e][positions[e].length-1]||(t=positions[target].pop(),positions[e].push(t),offset=50-offset,target=null,score++,scoreText.text=`移動回数
${score}回`)}},xs=[...Array(5)].map(e=>10*Math.random()),ys=[...Array(5)].map(e=>10*Math.random()),rotations=[...Array(5)].map(e=>(Math.random()<.5?1:-1)*Math.random()*10);function update(){if(5===positions[2].length&&(passedText.text="クリア！",resetText.text="もう一度プレイ",resetText.setFill("#000"),resetText.x=245,resetText.y=280,exploded))puddings.forEach((e,t)=>{(e.x+xs[t]<0||640<e.x+xs[t])&&(xs[t]=-xs[t]),(e.y+ys[t]<0||480<e.y+ys[t])&&(ys[t]=-ys[t]),e.x+=xs[t],e.y+=ys[t],e.angle+=rotations[t]});else for(var[e,t]of positions.entries())if(0!==t.length)for(var[s,a]of t.entries()){const xs=[115,325,535],ys=[350,365,375,385,395];var o=e===target&&s+1===t.length?1:0,s=t.slice(0,s).map(e=>puddings[e].height*scales[e]/2).reduce((e,t)=>e+t,0);puddings[a].x=xs[e],puddings[a].y=ys[t[0]]-s-offset*o}}</script>